<!--<!DOCTYPE html>-->
<!--<html lang="vi" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"-->
<!--      layout:decorate="~{View/Layout/AdminLayout.html}">-->

<!--<head>-->
<!--  <title>Quản lý tài xế</title>-->
<!--  <meta charset="UTF-8">-->
<!--  <title>Quản lý Xe</title>-->
<!--  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">-->
<!--  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">-->
<!--</head>-->

<!--<body>-->
<!--<div layout:fragment="content">-->
<!--  <div class="container mx-auto p-4">-->
<!--    <h1 class="text-2xl font-bold mb-4">Quản Lý Tài Xế</h1>-->

<!--    &lt;!&ndash; Search &ndash;&gt;-->
<!--    <form id="searchForm" action="/admin/drivers/search" method="get">  &lt;!&ndash; Added id to the form &ndash;&gt;-->
<!--      <div class="mb-4 flex items-center">-->
<!--        <input type="text" name="keyword" id="keyword" placeholder="Tìm kiếm theo tên, email, mật khẩu"-->
<!--               class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline mr-2" onkeydown="handleKeyPress(event)">-->
<!--        <button type="submit" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded mt-2 mr-2">Tìm kiếm</button>-->
<!--        <i class="fas fa-microphone cursor-pointer" onclick="startSpeechRecognition()"></i>-->
<!--      </div>-->
<!--    </form>-->

<!--    &lt;!&ndash; Thông báo thành công hoặc lỗi &ndash;&gt;-->
<!--    <div>-->
<!--      <div th:if="${successMessage}"-->
<!--           class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-4" role="alert">-->
<!--        <span th:text="${successMessage}"></span>-->
<!--      </div>-->
<!--      <div th:if="${errorMessage}" class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4"-->
<!--           role="alert">-->
<!--        <span th:text="${errorMessage}"></span>-->
<!--      </div>-->
<!--    </div>-->

<!--&lt;!&ndash;    <div class="flex justify-end mb-4">&ndash;&gt;-->
<!--&lt;!&ndash;      <a href="/admin/accounts/add" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">&ndash;&gt;-->
<!--&lt;!&ndash;        Thêm Tài Khoản&ndash;&gt;-->
<!--&lt;!&ndash;      </a>&ndash;&gt;-->
<!--&lt;!&ndash;    </div>&ndash;&gt;-->

<!--    <table class="min-w-full bg-white">-->
<!--      <thead>-->
<!--      <tr>-->
<!--        <th class="py-2 px-4 border-b">ID Tài Xế</th>-->
<!--        <th class="py-2 px-4 border-b">Tên</th>-->
<!--        <th class="py-2 px-4 border-b">Số bằng lái</th>-->
<!--        <th class="py-2 px-4 border-b">Số điện thoại</th>-->
<!--        <th class="py-2 px-4 border-b">Địa chỉ</th>-->
<!--        <th class="py-2 px-4 border-b">Trạng Thái</th>-->
<!--      </tr>-->
<!--      </thead>-->
<!--      <tbody>-->
<!--      <tr th:each="driver : ${drivers}" class="text-center">-->
<!--        <td class="py-2 px-4 border-b" th:text="${driver.id}">1</td>-->
<!--        <td class="py-2 px-4 border-b" th:text="${driver.name}"></td>-->
<!--        <td class="py-2 px-4 border-b" th:text="${driver.licenseNumber}">Nguyen Van A</td>-->
<!--        <td class="py-2 px-4 border-b" th:text="${driver.phone}">abc123@gmail.com</td>-->
<!--        <td class="py-2 px-4 border-b" th:text="${driver.address}">*************</td>-->
<!--        <td class="py-2 px-4 border-b">-->
<!--          <select th:data-accountid="${driver.id}" onchange="updateAccountStatus(this)"-->
<!--                  th:classappend="${driver.accountStatus == T(com.example.ticketbooker.Util.Enum.AccountStatus).ACTIVE} ? 'bg-green-200 text-green-700 border-green-400' : 'bg-red-200 text-red-700 border-red-400'"-->
<!--                  class="shadow appearance-none border rounded w-full py-2 px-3 leading-tight focus:outline-none focus:shadow-outline text-center">-->
<!--            <option value="ACTIVE" th:selected="${driver.accountStatus == T(com.example.ticketbooker.Util.Enum.AccountStatus).ACTIVE}">ACTIVE</option>-->
<!--            <option value="INACTIVE" th:selected="${driver.accountStatus == T(com.example.ticketbooker.Util.Enum.AccountStatus).INACTIVE}">INACTIVE</option>-->
<!--          </select>-->
<!--        </td>-->
<!--        <td class="py-2 px-4 border-b">-->
<!--          <a th:href="@{/admin/accounts/{id}(id=${driver.id})}"-->
<!--             class="bg-yellow-500 hover:bg-yellow-700 text-white font-bold py-1 px-5 rounded mr-2">Sửa</a>-->
<!--          &lt;!&ndash;                    <button th:data-name="${`driver`.id}" onclick="deleteAccount(this)"&ndash;&gt;-->
<!--          &lt;!&ndash;                            class="bg-red-500 hover:bg-red-700 text-white font-bold py-1 px-2 rounded">Xóa&ndash;&gt;-->
<!--          &lt;!&ndash;                    </button>&ndash;&gt;-->
<!--        </td>-->
<!--      </tr>-->
<!--      </tbody>-->
<!--    </table>-->
<!--    <div class="mt-4 flex justify-center">-->
<!--      <ul class="flex">-->
<!--        <li th:each="i : ${#numbers.sequence(0, totalPages - 1)}" class="mx-1 px-3 py-2 rounded-lg"-->
<!--            th:classappend="${currentPage == i} ? 'bg-blue-500 text-white' : 'bg-gray-200'">-->
<!--          <a th:href="@{/admin/accounts(page=${i}, size=10)}" th:text="${i + 1}"></a>-->
<!--        </li>-->
<!--      </ul>-->
<!--    </div>-->
<!--  </div>-->
<!--</div>-->
<!--<div layout:fragment="popup">-->
<!--  &lt;!&ndash; modal &ndash;&gt;-->
<!--  <div-->
<!--          class="flex items-start modal md:px-3 absolute bottom-0  md:w-2/3 h-1/2 bg-gray-100/90 border border-bg-white/95 backdrop-blur-lg md:rounded-2xl shadow-md shadow-gray-200 ease-in-out transition-all duration-700">-->
<!--    <div class="flex flex-grow flex-col justify-start items-start">-->
<!--      <div-->
<!--              class="text-center w-full uppercase font-semibold grid grid-cols-12 md:py-4 border border-transparent border-b-zinc-300">-->
<!--        <div class="col-span-2">-->
<!--          <button-->
<!--                  class="font-semibold text-blue-500 no-underline outline-none hover:outline-none add-user-close">-->
<!--            Hủy-->
<!--          </button>-->
<!--        </div>-->
<!--        <div class="col-span-8 text-center">-->

<!--        </div>-->
<!--        <div class="col-span-2 flex items-center justify-center">-->
<!--          <button-->
<!--                  class="font-semibold text-blue-500 no-underline outline-none hover:outline-none add-user-submit">-->
<!--            Thêm-->
<!--          </button>-->
<!--        </div>-->
<!--      </div>-->
<!--      <form id="add-user-form" th:action="@{/admin/drivers/create}" th:object="${createDriverForm}" method="post"-->
<!--            class="w-full h-full md:px-5 md:mt-7">-->
<!--        <div class="w-full flex flex-col md:my-3 items-start justify-evenly">-->
<!--          <label for="name" class="capitalize font-medium">Họ và tên: </label>-->
<!--          <input id="name" type="text" th:field="*{name}"-->
<!--                 class="w-full focus:outline-none flex-grow shadow-inner shadow-gray-200 rounded-md p-1 border border-gray-400 bg-white"-->
<!--                 required pattern="[a-zA-Z]" placeholder="Họ và tên...">-->
<!--        </div>-->
<!--        <div class="w-full flex flex-col md:my-3 items-start justify-evenly">-->
<!--          <label for="phone" class="capitalize font-medium">Số điện thoại:</label>-->
<!--          <input id="phone" type="text" th:field="*{phone}"-->
<!--                 class="w-full focus:outline-none flex-grow shadow-inner shadow-gray-200 rounded-md p-1 border border-gray-400 bg-white"-->
<!--                 required pattern="[a-zA-Z]" placeholder="Số điện thoại...">-->
<!--        </div>-->
<!--        <div class="w-full flex flex-col md:my-3 items-start justify-evenly">-->
<!--          <label for="address" class="capitalize font-medium">Địa chỉ liên hệ:</label>-->
<!--          <input id="address" type="text" th:field="*{address}"-->
<!--                 class="w-1/2 focus:outline-none flex-grow shadow-inner shadow-gray-200 rounded-md p-1 border border-gray-400 bg-white"-->
<!--                 placeholder="Địa chỉ...">-->
<!--        </div>-->
<!--        <div class="w-full flex flex-col md:my-3 items-start justify-evenly">-->
<!--          <label for="licenseNumber" class="capitalize font-medium">Bằng lái:</label>-->
<!--          <input id="licenseNumber" type="text" th:field="*{licenseNumber}"-->
<!--                 class="w-1/2 focus:outline-none flex-grow shadow-inner shadow-gray-200 rounded-md p-1 border border-gray-400 bg-white"-->
<!--                 placeholder="Số đăng ký bằng lái...">-->
<!--        </div>-->
<!--        <div class="w-full flex flex-col md:my-3 items-start justify-evenly">-->
<!--          <label for="driverStatus" class="capitalize font-medium">Trạng thái:</label>-->
<!--          <select id="driverStatus" type="text" th:field="*{driverStatus}"-->
<!--                  class="w-full focus:outline-none flex-grow shadow-inner shadow-gray-200 rounded-md p-1 border border-gray-400 bg-white">-->
<!--            <option value="ACTIVE" selected> Active </option>-->
<!--          </select>-->
<!--        </div>-->

<!--      </form>-->
<!--    </div>-->
<!--  </div>-->
<!--  &lt;!&ndash; /modal &ndash;&gt;-->
<!--</div>-->

<!--</body>-->

<!--</html>-->
<!--<script type="text/javascript" th:src="@{/js/DriverManagement.js}"></script>-->

<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{View/Layout/AdminLayout.html}">
<head>
  <meta charset="UTF-8">
  <title>Quản lý Lái Xe</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <script>
    function updateDriverStatus(select) {
      const driverId = select.dataset.driverid;
      alert(driverId)
      const newStatus = select.value;

      fetch(`/api/drivers/${driverId}/status`, {
        method: 'PATCH',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({ driverStatus: newStatus })
      })
              .then(response => {
                if (response.ok) {
                  alert('Cập nhật trạng thái thành công!');
                  window.location.reload();
                } else {
                  alert('Cập nhật trạng thái thất bại!');
                }
              })
              .catch(error => {
                console.error('Error:', error);
                alert('Cập nhật trạng thái thất bại!');
              });
    }

    function handleKeyPress(event) {
      if (event.keyCode === 13) {
        document.getElementById('searchForm').submit();
      }
    }
  </script>
</head>
<body class="bg-gray-100">
<div layout:fragment="content">
  <div class="container mx-auto p-4">
    <h1 class="text-2xl font-bold mb-4">Quản Lý Lái Xe</h1>

    <!-- Search -->
    <form id="searchForm" action="/admin/drivers/search" method="get">
      <div class="mb-4 flex items-center">
        <input type="text" name="keyword" id="keyword" placeholder="Tìm kiếm theo tên, số giấy phép"
               class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline mr-2" onkeydown="handleKeyPress(event)">
        <button type="submit" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded mt-2 mr-2">Tìm kiếm</button>
      </div>
    </form>

    <!-- Thông báo thành công hoặc lỗi -->
    <div>
      <div th:if="${successMessage}"
           class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-4" role="alert">
        <span th:text="${successMessage}"></span>
      </div>
      <div th:if="${errorMessage}" class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4"
           role="alert">
        <span th:text="${errorMessage}"></span>
      </div>
    </div>

    <div class="flex justify-end mb-4">
      <a href="/admin/drivers/add" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded">
        Thêm Lái Xe
      </a>
    </div>

    <table class="min-w-full bg-white">
      <thead>
      <tr>
        <th class="py-2 px-4 border-b">ID</th>
        <th class="py-2 px-4 border-b">Tên</th>
        <th class="py-2 px-4 border-b">Số Giấy Phép</th>
        <th class="py-2 px-4 border-b">Số Điện Thoại</th>
        <th class="py-2 px-4 border-b">Địa Chỉ</th>
        <th class="py-2 px-4 border-b">Trạng Thái</th>
        <th class="py-2 px-4 border-b">Hành Động</th>
      </tr>
      </thead>
      <tbody>
      <tr th:each="driver : ${drivers}" class="text-center">
        <td class="py-2 px-4 border-b" th:text="${driver.id}"></td>
        <td class="py-2 px-4 border-b" th:text="${driver.name}"></td>
        <td class="py-2 px-4 border-b" th:text="${driver.licenseNumber}"></td>
        <td class="py-2 px-4 border-b" th:text="${driver.phone}"></td>
        <td class="py-2 px-4 border-b" th:text="${driver.address}"></td>
        <td class="py-2 px-4 border-b">
          <select th:data-driverid="${driver.id}" onchange="updateDriverStatus(this)"
                  th:classappend="${driver.driverStatus == T(com.example.ticketbooker.Util.Enum.DriverStatus).ACTIVE} ? 'bg-green-200 text-green-700 border-green-400' : 'bg-red-200 text-red-700 border-red-400'"
                  class="shadow appearance-none border rounded w-full py-2 px-3 leading-tight focus:outline-none focus:shadow-outline text-center">
            <option value="ACTIVE" th:selected="${driver.driverStatus == T(com.example.ticketbooker.Util.Enum.DriverStatus).ACTIVE}">ACTIVE</option>
            <option value="INACTIVE" th:selected="${driver.driverStatus == T(com.example.ticketbooker.Util.Enum.DriverStatus).INACTIVE}">INACTIVE</option>
          </select>
        </td>
        <td class="py-2 px-4 border-b">
          <a th:href="@{/admin/drivers/{id}(id=${driver.id})}"
             class="bg-yellow-500 hover:bg-yellow-700 text-white font-bold py-1 px-5 rounded mr-2">Sửa</a>
        </td>
      </tr>
      </tbody>
    </table>
    <div class="mt-4 flex justify-center">
      <ul class="flex">
        <li th:each="i : ${#numbers.sequence(0, totalPages - 1)}" class="mx-1 px-3 py-2 rounded-lg"
            th:classappend="${currentPage == i} ? 'bg-blue-500 text-white' : 'bg-gray-200'">
          <a th:href="@{/admin/drivers(page=${i}, size=10)}" th:text="${i + 1}"></a>
        </li>
      </ul>
    </div>
  </div>
</div>
</body>
</html>
